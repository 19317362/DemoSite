<link rel="import" href="/web-components/lib/polymer/polymer.html">
<link rel="import" href="/web-components/lib/core-image/core-image.html">
<link rel="import" href="/web-components/data/blc-data.html">

<polymer-element name="hc-cart-item">
	<template>
		<blc-data-product productId="{{cartItem.productId}}" product={{product}}></blc-data-product>
		<blc-data-remove-from-cart customerId="100" itemId="{{cartItem.id}}" quantity="{{cartItem.quantity}}" on-response="{{removeFromCartSuccess}}"></blc-data-remove-from-cart>
		
		<div id="container">
			<core-image id="thumbnail" src="{{product.mediaItems[0].url}}" sizing="cover" preload fade></core-image>
			
			<div id="title">
				<a href="{{product.url}}">
					{{product.name}}
				</a>
			</div>
			
			<div id="quantity">
				{{cartItem.quantity}}
			</div>
			
			<div id="price">
				${{cartItem.retailPrice.amount}}
			</div>
			
			<div id="savings">
				${{cartItem.retailPrice.amount - cartItem.salePrice.amount}}
			</div>
			
			<div id="total">
				${{cartItem.salePrice.amount}}
			</div>
			
			<paper-icon-button id="remove-button" icon="highlight-remove" on-click="{{removeFromCart}}"></paper-icon-button>
		</div>
		
		<!-- Global style -->
		<link rel="stylesheet" href="/css/web-components-global-styles.css">
		<style>
			#container {
				height:50px;
				padding: 10px;
			}
		
			#thumbnail {
				width: 50px;
				height: 50px;
				float:left;
			}
			
			#container > * {
				float:left;
				text-align:center;
				vertical-align:middle;
				height:100%;
			}
			#title {
				width: 200px;
				padding:10px;
			}
			#title a {
				font: 14px/18px 'Oxygen', Helvetica, sans-serif;
				color: #E40037;
				text-decoration:none;
			}
			#title a:visited {
				color: #E40037;
			}
			#quantity {
				width: 10%;
			}
			#price {
				width: 10%;
			}
			#savings {
				width:10%;
			}
			#total {
				width:10%;
			}
			
			#remove-button {
				float:right;
			}
		
		</style>
	</template>
	<script>
		Polymer({
			publish: {
				cartItem: {
					value: {},
					reflect: true
				}
			},
			
			removeFromCart: function(){
				this.shadowRoot.querySelector('blc-data-remove-from-cart').go();
			},
			removeFromCartSuccess: function() {
				this.fire('remove-from-cart', {itemId: this.cartItem.id})
			}
		});
	</script>
</polymer-element>