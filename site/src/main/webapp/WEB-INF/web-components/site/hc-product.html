<link rel="import" href="/web-components/lib/polymer/polymer.html">
<link rel="import" href="/web-components/lib/core-image/core-image.html">
<link rel="import" href="/web-components/data/blc-data.html">

<polymer-element name="hc-product">
	<template>
		<blc-data-product productId="{{productId}}" product={{product}}></blc-data-product>
		<blc-data-product-skus productId="{{productId}}" skus="{{skus}}"></blc-data-product-skus>
		<blc-data-add-to-cart customerId="100" productId="{{productId}}" quantity="1" categoryId="{{product.defaultCategoryId}}" on-response="{{addToCartSuccess}}"></blc-data-add-to-cart>
		
		<div id="container">
			<template if="{{product.id == 9}}">
				<core-image id="new-badge" src="/img/badge-new.png" sizing="cover" preload></core-image>
			</template>
		
			<a href="{{product.url}}">
				<core-image id="thumbnail" src="{{product.mediaItems[1].url}}" sizing="cover" preload fade></core-image>
				<div id="price">${{product.retailPrice.amount}}</div>
			</a>
			<div id="text">
				<div id="title">{{product.name}}</div>
				<p>{{product.longDescription}}</p>
			</div>
			<paper-button id="add-to-cart" raised on-click="{{addToCart}}">BUY NOW!</paper-button>
		</div>
		
		<!-- Global style -->
		<link rel="stylesheet" href="/css/web-components-global-styles.css">
		<style>
			#container {
				width: 220px;
				height: 440px;
				text-align: center;
				float: left;
				display: inline;
				position: relative;
			}
			#new-badge {
				position:absolute;
				top:-10px;
				left:-10px;
				z-index: 20;
				width:60px;
				height:60px;
			}
			#thumbnail {
				width: 220px;
				height: 220px;
			}
			
			#price {
				position: absolute;
				background-color: black;
				color: white;
				opacity: 0.8;
				padding: 10px 20px;
				font: 16px/16px 'Open Sans', Helvetica, sans-serif;
				font-weight: 600;
				bottom: 226px;
				right: 5px;
			}
			
			#text {
				width: 220px;
				height: 118px;
				font: 13px/18px 'Georgia',serif;
				color: #655c5a;
				overflow: hidden;
				max-height: 118px;
			}
			#title {
				width: 220px;
				font: 18px/21px 'Oxygen', Helvetica, sans-serif;
				margin-bottom: 7px;
				color: #262322;
			}
			
			#add-to-cart {
				width:150px;
				height:45px;
				margin-top: 10px;
				font-weight: 600;
				line-height:22.6px;
			}
			#add-to-cart[disabled] {
				background: #eaeaea;
				color: #a8a8a8;
				cursor: auto;
				pointer-events: none;
			}
		</style>
	</template>
	<script>
		Polymer({
			addToCart: function(){
				this.shadowRoot.querySelector('blc-data-add-to-cart').go();
			},
			addToCartSuccess: function() {
				this.shadowRoot.querySelector('#add-to-cart').setAttribute('disabled', '');
				this.shadowRoot.querySelector('#add-to-cart').innerHTML = 'In cart!';
				this.fire('add-to-cart', {product: this.product})
			},
			
			publish: {
				productId: {
					value: 1,
					reflect: true
				}
			}
		});
	</script>
</polymer-element>