<link rel="import" href="/web-components/lib/polymer/polymer.html">
<link rel="import" href="/web-components/lib/core-ajax/core-ajax.html">

<polymer-element name="blc-data-category" attributes="auto">
	<template>
		<core-ajax
		    auto="{{auto}}"
		    url="/api/v1/catalog/category/{{categoryId}}?productLimit={{productLimit}}&productOffset={{productOffset}}&subcategoryOffset={{subcategoryOffset}}&subcategoryDepth={{subcategoryDepth}}"
		    contentType="application/json"
		    handleAs="json"
		    response="{{category}}"
		    on-core-response="{{onResponse}}"
		    on-core-error="{{onError}}"
		    on-core-complete="{{onComplete}}"></core-ajax>
	</template>
	<script>
		Polymer({
		    auto: true,
		    go: function() {
		    	this.shadowRoot.querySelector('core-ajax').go();
		    },
		    onResponse: function(event) {
		    	this.fire('response', event);
		    },
		    onError: function(event) {
		    	this.fire('error', event);
		    },
		    onComplete: function(event) {
		    	this.fire('complete', event);
		    },
		    
			publish: {
				categoryId: {
					value: 1,
					reflect: true
				},
				productLimit: {
					value: 20,
					reflect: true
				},
				productOffset: {
					value: 1,
					reflect: true
				},
				subcategoryOffset: {
					value: 1,
					reflect: true
				},
				subcategoryDepth: {
					value: 1,
					reflect: true
				},
				
				category: {
					value: {},
					reflect: true
				}
			}
		});
	</script>
</polymer-element>