<div class="ruleBuilder">

    <blc_admin:admin_rule_builder
            entities="${ruleBuilder.entities}"
            fieldName="${ruleBuilder.fieldName}"
            ceilingEntity="${ruleBuilder.ceilingEntity}"
            configKey="${ruleBuilder.configKey}"
            mvelProperty="${ruleBuilder.mvelProperty}"
            resultVar="wrappers" />

    <!-- Add field name to ID instead of count -->
    <div th:each="wrapper : ${wrappers}" th:id="${wrapper.containerId}"/>

    <script type="text/javascript" th:each="wrapper : ${wrappers}" th:inline="javascript">
        /*<![CDATA[*/
        var conditionsArray = Object.prototype.toString.call(conditionsArray) == "[object Array]" ? conditionsArray : [];

        function Conditions() {
            this.json = /*[[${wrapper.conditions}]]*/ {};
            this.containerId = /*[[${wrapper.containerId}]]*/'';
        }

        conditionsArray.push(new Conditions());
        /*]]>*/
    </script>
</div>